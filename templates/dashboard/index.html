{% extends "dashboard/base.html" %}

{% block title %}Dashboard{% endblock %}
{% block page_title %}Dashboard Overview{% endblock %}

{% block breadcrumb %}
<nav aria-label="breadcrumb">
    <ol class="breadcrumb">
        <li class="breadcrumb-item active" aria-current="page">Dashboard</li>
    </ol>
</nav>
{% endblock %}

{% block content %}
<div class="row g-4">
    <!-- Stats Cards -->
    {% if session.get('is_admin') %}
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-users-cog fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">System</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Total Users</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.total_users }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-user-check fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">{{ stats.verified_users }} Verified</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Active Users</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.active_users }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-envelope fa-lg text-gold"></i>
                    </div>
                    {% if stats.unread_messages > 0 %}
                    <span class="badge bg-danger rounded-pill px-3">{{ stats.unread_messages }} New</span>
                    {% else %}
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">Messages</span>
                    {% endif %}
                </div>
                <h6 class="text-muted mb-1 fw-600">Total Messages</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.total_messages }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-chart-line fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">30 Days</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Recent Visitors</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.recent_visitors }}</h3>
            </div>
        </div>
    </div>
    {% else %}
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-briefcase fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">Total</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Active Projects</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.projects }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-brain fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">Skills</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Core Competencies</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.skills }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-envelope-open-text fa-lg text-gold"></i>
                    </div>
                    {% if stats.unread_messages > 0 %}
                    <span class="badge bg-danger rounded-pill px-3">{{ stats.unread_messages }} New</span>
                    {% else %}
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">Messages</span>
                    {% endif %}
                </div>
                <h6 class="text-muted mb-1 fw-600">Inbound Requests</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.messages }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-chart-line fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-success bg-opacity-10 text-success rounded-pill px-3">+{{ stats.today_visitors }} today</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Visitor Reach</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.visitors }}</h3>
            </div>
        </div>
    </div>
    <div class="col-xl-3 col-md-6">
        <div class="card border-0 shadow-sm">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-center mb-3">
                    <div class="icon-shape bg-soft-gold rounded-3 p-3">
                        <i class="fas fa-concierge-bell fa-lg text-gold"></i>
                    </div>
                    <span class="badge bg-soft-gold text-gold rounded-pill px-3">Services</span>
                </div>
                <h6 class="text-muted mb-1 fw-600">Service Offerings</h6>
                <h3 class="mb-0 text-white fw-700">{{ stats.services }}</h3>
            </div>
        </div>
    </div>
    {% endif %}
</div>

<div class="row mt-5 g-4">
    <div class="col-lg-8">
        <div class="card h-100">
            <div class="card-header bg-transparent border-bottom border-white border-opacity-10 p-4">
                <h5 class="mb-0 text-white fw-600"><i class="fas fa-bolt me-2 text-gold"></i>Quick Action Center</h5>
            </div>
            <div class="card-body p-4">
                <div class="row g-3">
                    {% if session.get('is_admin') %}
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.users') }}" class="btn btn-gold-gradient w-100 py-3 rounded-3 shadow-sm">
                            <i class="fas fa-users-cog me-2"></i>Manage Users
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.settings') }}" class="btn btn-outline-gold w-100 py-3 rounded-3">
                            <i class="fas fa-shield-alt me-2"></i>System Security
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('pages.landing') }}" target="_blank" class="btn btn-outline-gold w-100 py-3 rounded-3">
                            <i class="fas fa-globe me-2"></i>Platform View
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('auth.logout') }}" class="btn btn-outline-danger w-100 py-3 rounded-3">
                            <i class="fas fa-power-off me-2"></i>Terminate Session
                        </a>
                    </div>
                    {% else %}
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.add_project') }}" class="btn btn-gold-gradient w-100 py-3 rounded-3 shadow-sm">
                            <i class="fas fa-plus-circle me-2"></i>New Project Entry
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.general') }}" class="btn btn-outline-gold w-100 py-3 rounded-3">
                            <i class="fas fa-id-badge me-2"></i>Update Identity
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.messages') }}" class="btn btn-outline-gold w-100 py-3 rounded-3">
                            <i class="fas fa-comments-alt me-2"></i>Review Inbox
                        </a>
                    </div>
                    <div class="col-md-6">
                        <a href="{{ url_for('dashboard.settings') }}" class="btn btn-outline-gold w-100 py-3 rounded-3">
                            <i class="fas fa-cog me-2"></i>System Config
                        </a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
    
    <div class="col-lg-4">
        <div class="card h-100">
            <div class="card-header bg-transparent border-bottom border-white border-opacity-10 p-4">
                <h5 class="mb-0 text-white fw-600"><i class="fas fa-shield-check me-2 text-gold"></i>Account Diagnostics</h5>
            </div>
            <div class="card-body p-4">
                <div class="text-center mb-4">
                    {% if session.get('is_admin') %}
                    <div class="avatar-xl mx-auto mb-3 bg-soft-gold rounded-circle d-flex align-items-center justify-content-center avatar-80">
                        <i class="fas fa-user-shield fa-3x text-gold"></i>
                    </div>
                    <h5 class="text-white fw-700">Root Administrator</h5>
                    <p class="small opacity-50 mb-0">Full System Sovereignty</p>
                    {% elif stats.get('is_demo') %}
                    <div class="avatar-xl mx-auto mb-3 bg-soft-gold rounded-circle d-flex align-items-center justify-content-center avatar-80">
                        <i class="fas fa-graduation-cap fa-3x text-warning"></i>
                    </div>
                    <h5 class="text-warning fw-700">Training Phase</h5>
                    <p class="small opacity-50 mb-4">Complete your professional path to unlock full access</p>
                    {% if stats.get('account_diagnostics') %}
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <small class="text-muted">Portfolio Setup</small>
                            <small class="text-white fw-600">{{ stats.account_diagnostics.portfolio_setup.completed }}/{{ stats.account_diagnostics.portfolio_setup.total }}</small>
                        </div>
                        <div class="progress mb-2" style="height: 6px;">
                            <div class="progress-bar bg-warning" role="progressbar" style="width: {{ stats.account_diagnostics.portfolio_setup.progress|round }}%" aria-valuenow="{{ stats.account_diagnostics.portfolio_setup.progress|round }}" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                    <div class="mb-3">
                        <div class="d-flex justify-content-between align-items-center mb-2">
                            <small class="text-muted">Content Creation</small>
                            <small class="text-white fw-600">{{ stats.account_diagnostics.content_creation.completed }}/{{ stats.account_diagnostics.content_creation.total }}</small>
                        </div>
                        <div class="progress mb-3" style="height: 6px;">
                            <div class="progress-bar bg-warning" role="progressbar" style="width: {{ stats.account_diagnostics.content_creation.progress|round }}%" aria-valuenow="{{ stats.account_diagnostics.content_creation.progress|round }}" aria-valuemin="0" aria-valuemax="100"></div>
                        </div>
                    </div>
                    {% if stats.account_diagnostics.overall.can_upgrade %}
                    <div class="text-center mb-3">
                        <span class="badge bg-success rounded-pill px-3 py-2">
                            <i class="fas fa-check-circle me-1"></i>Ready for Full Access
                        </span>
                    </div>
                    <a href="{{ url_for('dashboard.access_instructions') }}" class="btn btn-gold-gradient btn-sm px-4 w-100">Request Upgrade</a>
                    {% else %}
                    <div class="text-center mb-3">
                        <small class="text-muted">{{ "%.0f"|format(stats.account_diagnostics.overall.progress) }}% Complete</small>
                    </div>
                    <a href="{{ url_for('dashboard.access_instructions') }}" class="btn btn-gold-gradient btn-sm px-4 w-100">View Requirements</a>
                    {% endif %}
                    {% else %}
                    <div class="progress mb-3 progress-6px">
                        <div class="progress-bar bg-warning" role="progressbar" style="width: 0%;" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100"></div>
                    </div>
                    <a href="{{ url_for('dashboard.access_instructions') }}" class="btn btn-gold-gradient btn-sm px-4 w-100">Inquire Full Access</a>
                    {% endif %}
                    {% else %}
                    <div class="avatar-xl mx-auto mb-3 bg-soft-gold rounded-circle d-flex align-items-center justify-content-center avatar-80">
                        <i class="fas fa-crown fa-3x text-gold"></i>
                    </div>
                    <h5 class="text-success fw-700">Elite Professional</h5>
                    <p class="small opacity-50 mb-0">Public Visibility Active</p>
                    {% endif %}
                </div>
                <div class="border-top border-white border-opacity-10 pt-4">
                    <div class="d-flex justify-content-between mb-2">
                        <span class="small opacity-50">Authorized as</span>
                        <span class="small fw-600">{{ session.get('username') }}</span>
                    </div>
                    <div class="d-flex justify-content-between">
                        <span class="small opacity-50">Last session</span>
                        <span class="small fw-600">{{ session.get('last_login', 'Online Now') }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<style>
    .bg-soft-gold { background: rgba(212, 175, 55, 0.1); }
    .text-gold { color: var(--primary-gold); }
    .btn-gold-gradient {
        background: var(--gold-gradient);
        color: #000;
        font-weight: 700;
        border: none;
        transition: var(--transition);
    }
    .btn-gold-gradient:hover {
        opacity: 0.9;
        transform: translateY(-2px);
        color: #000;
    }
    .btn-outline-gold {
        color: var(--primary-gold);
        border: 1px solid rgba(212, 175, 55, 0.3);
        font-weight: 600;
        transition: var(--transition);
    }
    .btn-outline-gold:hover {
        background: rgba(212, 175, 55, 0.05);
        border-color: var(--primary-gold);
        color: var(--primary-gold);
        transform: translateY(-2px);
    }
    .fw-600 { font-weight: 600; }
    .fw-700 { font-weight: 700; }
</style>
{% endblock %}
